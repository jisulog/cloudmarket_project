{% extends 'base.html' %}

{% block content %}
<!-- 검색 창 -->
<div class="row justify-content-end my-3">
  <div class="col-4 input-group">
      <input type="text" class="form-control kw" value="{{ kw|default_if_none:'' }}">
      <div class="input-group-append">
          <button class="btn btn-outline-secondary" type="button" id="btn_search">찾기</button>
      </div>
  </div>
</div>
<div class="container">
  <h5 class="my-3 border-bottom pb-2">상품 등록하기</h5>
  <form method="post" class="post-form my-3" enctype="multipart/form-data" action=".">
      {% csrf_token %}
      {{ form.as_p }}
      <button type="submit" class="btn btn-primary">저장하기</button>
      <input type="button" class="btn btn-primary" value="취소하기" onclick="history.back(-1);">
  </form>
</div>

<!-- 검색 폼  -->
<form id="searchForm" method="get" action="{% url 'market:postlist' %}">
  <input type="hidden" id="kw" name="kw" value="{{ kw|default_if_none:'' }}">
  <input type="hidden" id="page" name="page" value="{{ page }}">
</form>

{% endblock %}
{% block script %}
<script type='text/javascript'>
//console.log('자바스크립트 초입');
//document.write('자바스크립트 초입');
$(document).ready(function(){
    $(".page-link").on('click', function() {
        $("#page").val($(this).data("page"));
        $("#searchForm").submit();
    });

    $("#btn_search").on('click', function() {
        //console.log('버튼 입력');
        //document.write('버튼 입력');
        $("#kw").val($(".kw").val());
        $("#page").val(1);  // 검색버튼을 클릭할 경우 1페이지부터 조회한다.
        $("#searchForm").submit();
    });
});
</script>
{% endblock %}
